<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IvyHeterogeneousCore: IvyHeterogeneousCore</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">IvyHeterogeneousCore<span id="projectnumber">&#160;v0.1.0</span>
   </div>
   <div id="projectbrief">A modified C++ standard library for hybrid computing with GPUs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">IvyHeterogeneousCore </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> A modified, header-first C++20 core library that provides STL-like components for heterogeneous execution (CPU + optional CUDA GPU), with explicit memory-domain control, custom allocators, stream/event abstractions, and autodiff-oriented math/data structures.</p>
<h1><a class="anchor" id="autotoc_md14"></a>
Legal Notice (Read First)</h1>
<ul>
<li>Repository content is provided for inspection purposes only.</li>
<li>Copying, use, execution, modification, distribution, or creation of derivative works is prohibited unless explicit prior written authorization is granted by Ulaşcan Sarıca.</li>
<li>Full legal terms: <a class="el" href="da/d19/md_LICENSE.html">License</a>.</li>
</ul>
<p>This repository is part of <code>IvyFramework</code> and is focused on reusable low-level infrastructure for hybrid computing.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md16"></a>
Table of Contents</h1>
<ul>
<li>What This Project Is</li>
<li>Key Capabilities</li>
<li>Repository Layout</li>
<li>Requirements</li>
<li>Build and Test</li>
<li>How to Use in Your Code</li>
<li>Core Concepts</li>
<li>Autodiff Module</li>
<li>Documentation (Doxygen)</li>
<li>Troubleshooting</li>
<li>License and Usage Approval</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md18"></a>
What This Project Is</h1>
<p><code>IvyHeterogeneousCore</code> provides a custom standard-library-like layer under <code>interface/std_ivy</code>, along with supporting config, memory, stream, and autodiff components under <code>interface/</code>.</p>
<p>Design goals:</p>
<ul>
<li>Keep APIs familiar to C++ users (<code>vector</code>, <code>unordered_map</code>, iterators, allocators, traits).</li>
<li>Make memory placement explicit (<code>Host</code>, <code>GPU</code>, <code>PageLocked</code>, <code>Unified</code>, <code>UnifiedPrefetched</code>).</li>
<li>Support both CPU and CUDA execution paths from shared interfaces.</li>
<li>Enable higher-level math/autodiff components to run on heterogeneous backends.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md20"></a>
Key Capabilities</h1>
<h2><a class="anchor" id="autotoc_md21"></a>
1) Heterogeneous containers and memory-aware STL-like layer</h2>
<p>From <code>interface/std_ivy/</code>:</p>
<ul>
<li><code>IvyVector</code> (<code>std_ivy/vector</code>) and aliasing via umbrella headers.</li>
<li><code>IvyUnorderedMap</code> (<code>std_ivy/unordered_map</code>) with custom key/hash-equality evaluators.</li>
<li>Iterator stack (contiguous, reverse, bucketed builders, traits/primitives).</li>
<li>Allocator/memory primitives (<code>IvyAllocator</code>, <code>IvyMemoryView</code>, <code>IvyPointerTraits</code>, <code>IvyUnifiedPtr</code>).</li>
</ul>
<h2><a class="anchor" id="autotoc_md22"></a>
2) Unified dispatch model for kernels</h2>
<p>From <code><a class="el" href="d8/d36/IvyKernelRun_8h.html" title="Unified kernel dispatch layer with GPU-first and CPU/OpenMP fallback execution.">interface/config/IvyKernelRun.h</a></code>:</p>
<ul>
<li><code><a class="el" href="d0/d44/structrun__kernel.html">run_kernel</a>&lt;Kernel_t&gt;(shared_mem, stream).parallel_1D/2D/3D(...)</code></li>
<li>GPU-first execution when CUDA is usable.</li>
<li>CPU/OpenMP fallback (with specialization support via <code>kernel_unit_unified</code>).</li>
</ul>
<h2><a class="anchor" id="autotoc_md23"></a>
3) Stream and event abstraction</h2>
<p>From <code>interface/stream/</code>:</p>
<ul>
<li>Common base abstractions: <code><a class="el" href="d2/dbe/classIvyBaseStream.html" title="Polymorphic base class for stream wrappers.">IvyBaseStream</a></code>, <code><a class="el" href="d7/d3d/classIvyBaseStreamEvent.html" title="Polymorphic base class for stream-event wrappers.">IvyBaseStreamEvent</a></code>.</li>
<li>CUDA implementations: <code>IvyCudaStream</code>, <code>IvyCudaEvent</code>.</li>
<li>CPU/no-op fallback implementations: <code><a class="el" href="d7/d26/classIvyBlankStream.html">IvyBlankStream</a></code>, <code><a class="el" href="d0/dca/classIvyBlankStreamEvent.html" title="Blank-stream event implementation for non-CUDA execution.">IvyBlankStreamEvent</a></code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md24"></a>
4) Autodiff and math-related foundations</h2>
<p>From <code>interface/autodiff/</code>:</p>
<ul>
<li>Base math types and arithmetic/function primitives.</li>
<li>Node/function/tensor/variable components.</li>
<li>Specialized functions (e.g. <code>cerf</code>).</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md26"></a>
Repository Layout</h1>
<p>Top-level structure:</p>
<ul>
<li><code>interface/</code> — public headers and core implementation headers.</li>
<li><code>bin/</code> — executable entry source files (<code>*.cc</code>) built by <code>make all</code>.</li>
<li><code>executables/</code> — generated binaries from <code>bin/</code>.</li>
<li><code>test/</code> — unit/integration-style test sources (<code>utest_*.cc</code>).</li>
<li><code>test_executables/</code> — generated test binaries from <code>make utests</code>.</li>
<li><code>makefile</code> — primary build entry.</li>
<li><code>Doxyfile</code> — Doxygen configuration (<code>PROJECT_NAME = IvyHeterogeneousCore</code>, version <code>v0.1.0</code>).</li>
<li><code>html/</code> — generated documentation output (if present after Doxygen run).</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md28"></a>
Requirements</h1>
<h2><a class="anchor" id="autotoc_md29"></a>
Baseline (Linux)</h2>
<ul>
<li><code>g++</code> or <code>clang++</code> with C++20 support.</li>
<li>GNU Make.</li>
</ul>
<h2><a class="anchor" id="autotoc_md30"></a>
Optional CPU parallelism</h2>
<ul>
<li>OpenMP-capable compiler/runtime (<code>-fopenmp</code> is auto-detected in the Makefile).</li>
</ul>
<h2><a class="anchor" id="autotoc_md31"></a>
Optional CUDA support</h2>
<ul>
<li>NVIDIA CUDA toolkit with <code>nvcc</code>.</li>
<li>The current Makefile CUDA path targets <code>-arch=sm_86</code>.<ul>
<li>If your GPU architecture differs, update the <code>CXXFLAGS</code> CUDA arch in <code>makefile</code>.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md32"></a>
Optional docs</h2>
<ul>
<li>Doxygen 1.9+ for API docs generation.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md34"></a>
Build and Test</h1>
<p>All commands below assume you are in the repository root.</p>
<h2><a class="anchor" id="autotoc_md35"></a>
1) Clean</h2>
<div class="fragment"><div class="line">make clean</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md36"></a>
2) Build binaries from &lt;tt&gt;bin/*.cc&lt;/tt&gt;</h2>
<div class="fragment"><div class="line">make all</div>
</div><!-- fragment --><p>Outputs are placed in <code>executables/</code>.</p>
<h2><a class="anchor" id="autotoc_md37"></a>
3) Build tests from &lt;tt&gt;test/*.cc&lt;/tt&gt;</h2>
<div class="fragment"><div class="line">make utests</div>
</div><!-- fragment --><p>Outputs are placed in <code>test_executables/</code>.</p>
<h2><a class="anchor" id="autotoc_md38"></a>
4) Build with CUDA enabled</h2>
<div class="fragment"><div class="line">make USE_CUDA=1 all</div>
<div class="line">make USE_CUDA=1 utests</div>
</div><!-- fragment --><p>Notes:</p>
<ul>
<li>In CUDA mode the Makefile switches to <code>nvcc</code> and enables <code>-D__USE_CUDA__</code> and <code>-rdc=true</code>.</li>
<li>OpenMP flags are disabled in the CUDA branch of the current Makefile.</li>
</ul>
<h2><a class="anchor" id="autotoc_md39"></a>
5) Run tests</h2>
<p>Each source in <code>test/</code> produces a counterpart binary in <code>test_executables/</code>.</p>
<p>Example:</p>
<div class="fragment"><div class="line">./test_executables/utest_IvyVector_basic</div>
<div class="line">./test_executables/utest_IvyUnorderedMap_basic</div>
<div class="line">./test_executables/utest_unified_ptr_basic</div>
</div><!-- fragment --><p>A convenient way to run all test executables:</p>
<div class="fragment"><div class="line">for t in ./test_executables/utest_*; do echo &quot;==&gt; $t&quot;; &quot;$t&quot;; done</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md41"></a>
How to Use in Your Code</h1>
<p>This library is consumed as headers from <code>interface/</code>.</p>
<h2><a class="anchor" id="autotoc_md42"></a>
Include path</h2>
<p>Add:</p>
<div class="fragment"><div class="line">-I/path/to/IvyHeterogeneousCore/interface</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md43"></a>
Example: use &lt;tt&gt;std_ivy::vector&lt;/tt&gt;</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="d8/d3f/IvyVector_8h.html">std_ivy/IvyVector.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="d8/d59/IvyStream_8h.html">stream/IvyStream.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(){</div>
<div class="line">  IvyGPUStream* stream = <a class="code hl_function" href="d7/da5/namespaceIvyStreamUtils.html#a9131ef08119d1d64ed5750e8678419ba">IvyStreamUtils::make_global_gpu_stream</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="d2/d97/classstd__ivy_1_1IvyVector.html">std_ivy::vector&lt;double&gt;</a> vec(5, IvyMemoryHelpers::IvyMemoryType::Host, stream, 1.0);</div>
<div class="line">  vec.push_back(IvyMemoryHelpers::IvyMemoryType::Host, stream, 2.0);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="d7/da5/namespaceIvyStreamUtils.html#a9ed99af707d97d428bcb95e47dcdd9c0">IvyStreamUtils::destroy_stream</a>(stream);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aIvyStream_8h_html"><div class="ttname"><a href="d8/d59/IvyStream_8h.html">IvyStream.h</a></div><div class="ttdoc">Unified stream/event aliases bridging CUDA and non-CUDA backends.</div></div>
<div class="ttc" id="aIvyVector_8h_html"><div class="ttname"><a href="d8/d3f/IvyVector_8h.html">IvyVector.h</a></div><div class="ttdoc">Umbrella header exposing the std_ivy vector implementation.</div></div>
<div class="ttc" id="aclassstd__ivy_1_1IvyVector_html"><div class="ttname"><a href="d2/d97/classstd__ivy_1_1IvyVector.html">std_ivy::IvyVector</a></div><div class="ttdoc">Forward declaration of IvyVector.</div><div class="ttdef"><b>Definition</b> IvyVectorImpl.hh:24</div></div>
<div class="ttc" id="anamespaceIvyStreamUtils_html_a9131ef08119d1d64ed5750e8678419ba"><div class="ttname"><a href="d7/da5/namespaceIvyStreamUtils.html#a9131ef08119d1d64ed5750e8678419ba">IvyStreamUtils::make_global_gpu_stream</a></div><div class="ttdeci">__HOST_DEVICE__ IvyGPUStream * make_global_gpu_stream()</div><div class="ttdoc">Build a non-owning wrapper to the global backend stream.</div><div class="ttdef"><b>Definition</b> IvyStream.h:55</div></div>
<div class="ttc" id="anamespaceIvyStreamUtils_html_a9ed99af707d97d428bcb95e47dcdd9c0"><div class="ttname"><a href="d7/da5/namespaceIvyStreamUtils.html#a9ed99af707d97d428bcb95e47dcdd9c0">IvyStreamUtils::destroy_stream</a></div><div class="ttdeci">__HOST_DEVICE__ void destroy_stream(Stream_t *&amp;stream)</div><div class="ttdoc">Destroy a previously created typed stream object.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md44"></a>
Example: run a kernel via &lt;tt&gt;run_kernel&lt;/tt&gt;</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="d8/d36/IvyKernelRun_8h.html">config/IvyKernelRun.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>saxpy_kernel{</div>
<div class="line">  <span class="keyword">static</span> __HOST_DEVICE__ <span class="keywordtype">void</span> kernel(<a class="code hl_typedef" href="d1/db3/IvyBasicTypes_8h.html#a4f444bfc2d9b446bd9e27c1d6f7f86f2">IvyTypes::size_t</a> i, <a class="code hl_typedef" href="d1/db3/IvyBasicTypes_8h.html#a4f444bfc2d9b446bd9e27c1d6f7f86f2">IvyTypes::size_t</a> n, <span class="keywordtype">float</span>* y, <span class="keywordtype">float</span> <span class="keyword">const</span>* x, <span class="keywordtype">float</span> a){</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_struct" href="d5/da6/structkernel__check__dims.html">kernel_check_dims&lt;saxpy_kernel&gt;::check_dims</a>(i, n)) y[i] += a * x[i];</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// run_kernel&lt;saxpy_kernel&gt;(0, stream).parallel_1D(n, y, x, a);</span></div>
<div class="ttc" id="aIvyBasicTypes_8h_html_a4f444bfc2d9b446bd9e27c1d6f7f86f2"><div class="ttname"><a href="d1/db3/IvyBasicTypes_8h.html#a4f444bfc2d9b446bd9e27c1d6f7f86f2">IvyTypes::size_t</a></div><div class="ttdeci">unsigned long long int size_t</div><div class="ttdoc">Unsigned size type used across Ivy interfaces.</div><div class="ttdef"><b>Definition</b> IvyBasicTypes.h:16</div></div>
<div class="ttc" id="aIvyKernelRun_8h_html"><div class="ttname"><a href="d8/d36/IvyKernelRun_8h.html">IvyKernelRun.h</a></div><div class="ttdoc">Unified kernel dispatch layer with GPU-first and CPU/OpenMP fallback execution.</div></div>
<div class="ttc" id="astructkernel__check__dims_html"><div class="ttname"><a href="d5/da6/structkernel__check__dims.html">kernel_check_dims</a></div><div class="ttdoc">Dimension-check policy for kernel dispatch.</div><div class="ttdef"><b>Definition</b> IvyKernelRun.h:70</div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md46"></a>
Core Concepts</h1>
<h2><a class="anchor" id="autotoc_md47"></a>
Memory domains</h2>
<p>Defined in <code><a class="el" href="d2/d12/namespaceIvyMemoryHelpers.html#a968c35d9f245459d30fd909562fa38a9" title="Supported memory domains used by Ivy alloc/transfer helpers.">IvyMemoryHelpers::IvyMemoryType</a></code>:</p>
<ul>
<li><code>Host</code></li>
<li><code>GPU</code></li>
<li><code>PageLocked</code></li>
<li><code>Unified</code></li>
<li><code>UnifiedPrefetched</code></li>
</ul>
<p>The helpers in <code><a class="el" href="d4/d78/IvyMemoryHelpers_8h.html" title="Allocation, construction, destruction, and transfer helpers across memory domains.">IvyMemoryHelpers.h</a></code> provide allocation/construct/destruct/transfer APIs across these domains.</p>
<h2><a class="anchor" id="autotoc_md48"></a>
Unified pointer model</h2>
<p><code>IvyUnifiedPtr</code> supports pointer semantics with memory-type metadata, capacity/size tracking, transfer operations, and shared/unique pointer-type behavior via <code>IvyPointerType</code>.</p>
<h2><a class="anchor" id="autotoc_md49"></a>
Stream-aware operations</h2>
<p>Most memory/container operations accept <code>IvyGPUStream*</code> (or stream refs in helper internals), allowing backend-aware execution ordering.</p>
<h2><a class="anchor" id="autotoc_md50"></a>
CPU/GPU execution strategy</h2>
<p>The dispatch layer in <code><a class="el" href="d8/d36/IvyKernelRun_8h.html" title="Unified kernel dispatch layer with GPU-first and CPU/OpenMP fallback execution.">IvyKernelRun.h</a></code> allows a single kernel interface to run:</p>
<ul>
<li>On GPU when available.</li>
<li>On CPU/OpenMP fallback otherwise.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md52"></a>
Autodiff Module</h1>
<p><code>interface/autodiff/</code> contains math and computation-graph components, including:</p>
<ul>
<li>Base and arithmetic primitives.</li>
<li>Node/function/type tags and client-management utilities.</li>
<li>Basic tensor/function/variable nodes.</li>
<li>Specialized mathematical functions.</li>
</ul>
<p>For concrete examples, inspect <code>test/utest_autodiff_basic_blocks.cc</code>.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md54"></a>
Documentation (Doxygen)</h1>
<p>This repository includes a full <code>Doxyfile</code>.</p>
<p>Generate docs:</p>
<div class="fragment"><div class="line">doxygen Doxyfile</div>
</div><!-- fragment --><p>Typical output is generated under <code>html/</code> (depending on your Doxygen settings and current output configuration).</p>
<hr  />
<h1><a class="anchor" id="autotoc_md56"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md57"></a>
Build fails in CUDA mode</h2>
<ul>
<li>Check CUDA toolkit and <code>nvcc</code> availability.</li>
<li>Verify GPU arch compatibility with <code>-arch=sm_86</code> in <code>makefile</code>.</li>
<li>Ensure your toolchain supports relocatable device code (<code>-rdc=true</code>).</li>
</ul>
<h2><a class="anchor" id="autotoc_md58"></a>
OpenMP not being used</h2>
<ul>
<li>OpenMP is auto-detected for non-CUDA builds; ensure compiler/runtime support.</li>
<li>In CUDA mode, current Makefile disables OpenMP flags.</li>
</ul>
<h2><a class="anchor" id="autotoc_md59"></a>
Missing symbols or include errors</h2>
<ul>
<li>Confirm <code>-I.../interface</code> is on your include path.</li>
<li>Compile sources as C++20 (<code>-std=c++20</code>).</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md61"></a>
License and Usage Approval</h1>
<p>This project is proprietary and restricted.</p>
<p>Use of this software is limited to <b>Ulaşcan Sarıca</b> unless explicit prior written authorization is granted by the developer.</p>
<p>For clarity:</p>
<ul>
<li>Viewing source is allowed for inspection.</li>
<li>Copying any part of the code is prohibited without prior written authorization.</li>
<li>Using or executing the software is prohibited without prior written authorization.</li>
<li>Modifying, redistributing, or creating derivative works is prohibited without prior written authorization.</li>
</ul>
<p>See the full legal terms in <a class="el" href="da/d19/md_LICENSE.html">License</a> (authoritative legal file: <code>LICENSE</code>). </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
